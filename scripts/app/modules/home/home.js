define("/modules/home/home",["require","exports","module","/modules/vue/vue","/modules/vue/vue-validator","/modules/vue/vue-common"],function(t){var e=t("/modules/vue/vue");e.use(t("/modules/vue/vue-validator"));{var a=t("/modules/vue/vue-common");new e({mixins:[a],el:"html",data:{title:"全球知名化妆品平台- 美美箱MEMEBOX",isPreview:!1,init:!1,homeData:[],flashData:!1,favorData:{},noMore:!1,pageIndex:1,dataBottom:{},dataLayer:null,bottomFix:!1,cartNumber:"",classify:"/m/productClassify/productClassify.html#",details:"/m/productDetails/productDetails.html#",dMask:null,dcd:5},methods:{closeBottom:function(t){t.preventDefault(),this.bottomFix=!1},initCart:function(t){var e=this;e.httpAjax({url:"/h5/newcart/count",showLoading:t,success:function(t){e.cartNumber=t.data.totalQty}})},getFavorList:function(t){var e,a=this;if(localStorage.user){var o=JSON.parse(localStorage.user);e=o.userId}else e="";var i={page:a.pageIndex,pageSize:"10",pageType:3,userId:e},s="/mobilev44/recommend/index";a.httpAjax({url:s,param:i,success:function(e){t?t(e):1==e.code&&(a.favorData=e.data)}})},initHome:function(){var t=this,e={type:1},a="/h5/view/index";t.isPreview&&(a="/h5/view/preindex"),t.httpAjax({url:"/h5/customer/info",complete:function(o){e.isNew=o.data.isNew,t.httpAjax({url:a,token:!1,forCache:!0,param:e,success:function(e){if(1==e.code){t.homeData=e.data.components,t.dataLayer=e.data.layerImgUrl,t.dataBottom=e.data.bottomImgUrl;for(var a=0,o=t.homeData.length;o>a;a++)if(10==t.homeData[a].component_type){t.getFlash(a);break}t.getFavorList(),t.initCart(!0),setTimeout(function(){t.bottomFix=!0,t.init=!0,t.$refs.loading.show=!1,t.initScroll()},500)}}})}})},getFlash:function(){function t(t){var e="";if(3!=t.secKillStatus)return!1;for(var o=0,i=t.productList.length;i>o;o++)e+=","+t.productList[o].productId;e=e.slice(1),a.httpAjax({domain:a.searchDomain,url:"/global/price",param:{productIds:e},success:function(e){for(var a=e.data,o=0,i=a.length;i>o;o++)t.productList[o].seckillStock=1==a[o].stockStatus&&1==t.productList[o].seckillStock?!0:!1}})}var a=this;a.httpAjax({url:"/h5/seckill/index",token:!1,alert:"false",success:function(o){1==o.code&&(console.log(o.data),1==o.data.secKillStatus||0==o.data.secKillStatus?a.flashData=!1:(a.flashData=o.data,t(a.flashData),e.set(a.flashData,"time",{}),a.countdown(a.flashData.secKillLeftTime/1e3,a.flashData.time,!1,function(){0!=a.flashData.nextSecKillLeftTime&&(a.flashData.secKillStatus=3,a.countdown(a.flashData.nextSecKillLeftTime/1e3,a.flashData.time,!1,function(){a.getFlash()}))})))}})},initScroll:function(){var t=this,e=document.getElementById("home-index").getElementsByClassName("favor");e.length>0&&(window.onscroll=function(){window.innerHeight+window.scrollY>=document.body.clientHeight&&(0==t.favorData.hasNext?t.noMore||(t.noMore=!0,t.popup({content:"没有更多商品了",time:1e3,autoClose:!0})):1!=t.favorData.hasNext||t.noMore||(t.noMore=!0,t.pageIndex++,t.getFavorList(function(e){1==e.code&&(e.data.items&&(t.favorData.items=t.favorData.items.concat(e.data.items)),1==e.data.hasNext&&(t.noMore=!1),t.favorData.hasNext=e.data.hasNext)})))})},hideDMask:function(){this.dMask=1,localStorage.dMask=1},downloadApp:function(){_maq.push(["_trackEvent","popup_click_h5",{}]),this.getAppUrl()}},ready:function(){_hmt.push(["_trackEvent","main_page","进入首页"])},created:function(){var t=this;t.isPreview=decodeURI(window.location.href).indexOf("preview")>0?!0:!1,t.initHome(),t.dMask=sessionStorage.dMask||localStorage.dMask,sessionStorage.dMask=1;var e=setInterval(function(){t.dcd--,t.dcd<=0&&(clearInterval(e),t.dMask=1)},1e3);1==t.getSearch("d")&&setTimeout(function(){t.getAppUrl()},1e3),t.isFanliApp(),"undefined"!=typeof Storage&&(sessionStorage.KEYNODE=1)}})}});