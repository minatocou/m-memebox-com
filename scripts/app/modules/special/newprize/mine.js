define("/modules/special/newprize/mine",["require","exports","module","/modules/vue/vue","/modules/vue/vue-common","/modules/app/app","/modules/vue/vue-validate","/modules/vue/vue-validator"],function(e){var t=e("/modules/vue/vue"),s=e("/modules/vue/vue-common"),a=e("/modules/app/app"),i=e("/modules/vue/vue-validate");t.use(e("/modules/vue/vue-validator")),vue=new t({mixins:[s,a,i],el:"html",data:{pageData:null,init:!0,showLogin:!1,showMyPrizes:!0,showAddress:!0,addressText:null,userInfo:{name:null,phone:null,address:null,province:null,city:null,district:null,street:null},showTime:{time:"获取验证码",show:""},param:{phone:"",authCode:""},activity_id:null,type:0,showPrize:!1,prize:!1,is_real:!1,wxShareShow:!1},validators:{username:{message:"请输入正确的姓名",check:function(e){return e=e.trim(),""==e||e.length>100||/{|}|\[|]|\/|\\|｝|｛|／/.test(e)?!1:!0}},phone:{message:"请输入11位正确的手机号码",check:function(e){return/^(13[0-9]|17[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/i.test(e)}},street:{message:"请输入正确的详细地址",check:function(e){return e=e.trim(),""==e||e.length>100||/{|}|\[|]|\/|\\|｝|｛|／/.test(e)?!1:!0}}},methods:{userInfoCall:function(e){if(e&&e.data&&e.data.token)this.errorMsg=e.data.token,localStorage.mmToken=e.data.token,this.initPage();else{try{this.errorMsg=JSON.stringify(e)}catch(t){alert(t)}this.initPage()}},initPage:function(){var e=this;e.httpAjax({url:"/h5/rafflev2/view",param:{activityId:e.activity_id,type:e.type},success:function(t){1==t.code&&(e.pageData=t.data,e.setTitle(e.pageData.raffle.info.name),e.address(),e.showPrize=!0)}})},address:function(){var e=this;if(this.showAddress=!0,e.pageData.address){console.log(e.pageData.address);for(var t in this.pageData.address)this.userInfo[t]=this.pageData.address[t];this.userInfo.address=this.userInfo.province+" "+this.userInfo.city+" "+this.userInfo.district}},addAddress:function(){var e=this;e.valiForm(function(){e.httpAjax({url:"/h5/rafflev2/editaddress",type:"POST",param:{province:e.userInfo.province,city:e.userInfo.city,district:e.userInfo.district,street:e.userInfo.street,phone:e.userInfo.phone,name:e.userInfo.name,activityId:e.activity_id},success:function(t){1==t.code&&(e.pageData.address=t.data,e.popup({content:"您的信息已提交成功，实物奖品的发放信息会通过短信形式通知您，请耐心等待哦。",type:"alert"}))}})})},selectCity:function(e){e.target.focus();var t=this,s=new mui.PopPicker({layer:3});s.setData(cityData3),s.show(function(e){t.userInfo.address=(e[0]||{}).text+" "+(e[1]||{}).text+" "+((e[2]||{}).text||(e[1]||{}).text),t.userInfo.province=(e[0]||{}).text,t.userInfo.postcode=(e[0]||{}).value,t.userInfo.city=(e[1]||{}).text,t.userInfo.district=(e[2]||{}).text||(e[1]||{}).text,t.userInfo.provinceId=(e[0]||{}).value})},trackPv:function(){var e=this,t={isWeixin:"wechatwheelpv",isApp:"APPwheelpv",other:"otherwheelpv"},s="";Object.keys(t).forEach(function(t,a){"function"==typeof e[a]&&e[a]()&&(s=t)}),s=s||t.other,_maq.push(["_trackEvent",s,{wheelPv:s}])}},ready:function(){this.init=!0,this.$refs.loading.show=!1},created:function(){var e=this;e.activity_id=e.getSearch("activityId"),e.type=e.getSearch("type"),e.trackPv(),e.isApp()?(localStorage.removeItem("mmToken"),e.app_userinfo()):e.initPage()}})});