define("/modules/special/group/details",["require","exports","module","/modules/vue/vue","/modules/vue/vue-validator","/modules/vue/vue-common","/modules/app/app"],function(t){var a=t("/modules/vue/vue");a.use(t("/modules/vue/vue-validator"));var o=t("/modules/vue/vue-common"),e=t("/modules/app/app");vue=new a({mixins:[o,e],el:"html",data:{title:"",init:!1,statusLabel:"",showPlayGroup:"",dataProductDetails:{},thumbnailUrl:"",grouponId:"",productId:"",lackNum:null,showShare:"",disappearTime:"",state:"组团中",stateText:{"未开团":"去开团","去参团":"去参团","已成团":"开新团"},errorMsg:null,getNum:0},methods:{playGroup:function(){var t=this;t.showPlayGroup=1},close:function(t){t.preventDefault();var a=this;a.showPlayGroup=""},closeShareMask:function(t){t.preventDefault();var a=this;a.showShare=!1,clearTimeout(a.disappearTime)},groupUrl:function(){var t=location.origin+this.page+"/payment/group.html?productId="+this.productId;return this.grouponId&&this.dataProductDetails.data.currentNum<this.dataProductDetails.data.totalNum&&(t+="&grouponId="+this.grouponId),this.getSearch("code")&&(t+="&code="+this.getSearch("code")),this.isWeixin()&&(t=this.getPayUrl(t)),t},userInfoCall:function(t){t&&t.data&&t.data.token?(this.errorMsg=t.data.token,localStorage.mmToken=t.data.token,this.getDetail()):this.getDetail()},getDetail:function(){var t=this;t.productId=t.getSearch("productId"),t.grouponId=t.getSearch("grouponId");var a={};t.productId&&(a.productId=t.productId),t.grouponId&&(a.grouponId=t.grouponId),t.httpAjax({url:"/h5/groupon/detail",param:a,showLoading:!0,success:function(a){if(1==a.code)if(a&&a.data&&a.data.productInfo&&1==a.data.productInfo.stockStatus){try{var o={title:"仅"+a.data.productInfo.price+"元！我买了【火爆韩国思密达】"+a.data.productInfo.name,desc:"宋仲基代言全球知名化妆品平台- 美美箱MEMEBOX来中国啦！100%正品，比出国买还便宜。",link:location.href,imgUrl:a.data.productInfo.thumbnailUrl[0]};t.set_share(o);var e={title:"仅"+a.data.productInfo.price+"元！我买了【火爆韩国思密达】"+a.data.productInfo.name,text:"宋仲基代言全球知名化妆品平台- 美美箱MEMEBOX来中国啦！100%正品，比出国买还便宜。",url:location.href,image:a.data.productInfo.thumbnailUrl[0]};t.isApp()&&(t.iosVer()>=360||t.androidVer()>=360)&&t.app_setShare(e)}catch(r){t.errorMsg=r}if(t.init=!0,t.$refs.loading.show=!1,t.dataProductDetails=a,t.setTitle(t.dataProductDetails.data.productInfo.name),t.productId=t.dataProductDetails.data.productInfo.productId,t.thumbnailUrl=t.dataProductDetails.data.productInfo.thumbnailUrl,t.grouponId=t.dataProductDetails.data.grouponId,t.grouponId==localStorage.grouponId&&localStorage.groupPhone&&(t.showShare=!0,t.disappearTime=setTimeout(function(){t.showShare=!1,console.log(0)},1e4)),t.state=t.dataProductDetails.data.statusLabel,"未开团"==t.state||"去参团"==t.state?t.state="组团中":"","已过期"==t.state?t.state="已取消":"",t.lackNum=t.dataProductDetails.data.lackNum,t.grouponId&&"0"==t.dataProductDetails.data.currentNum?t.dataProductDetails.data.currentNum="1":"",t.grouponId&&t.dataProductDetails.data.currentNum>t.dataProductDetails.data.totalNum?t.dataProductDetails.data.currentNum=t.dataProductDetails.data.totalNum:"",t.initSwipe(),localStorage.groupParam){var u=JSON.parse(localStorage.groupParam);u.productId=t.productId,localStorage.groupParam=JSON.stringify(u)}}else t.getNum++,t.getNum<5?setTimeout(t.getDetail,1e4):t.popup({content:"网络状态不太好,请稍后再试",type:"alert",autoClose:!1,ok:function(){location.href="list.html"}})}})}},ready:function(){},created:function(){var t=this;try{this.isApp()&&(t.iosVer()>=360||t.androidVer()>=360)&&!localStorage.mmToken?(this.app_userinfo(),setTimeout(function(){localStorage.mmToken||t.getDetail()},500)):this.getDetail()}catch(a){console.log(a),t.getDetail()}}})});