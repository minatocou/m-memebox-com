define("/modules/special/referral/app",["require","exports","module","/modules/vue/vue","/modules/vue/vue-validator","/modules/vue/vue-common","/modules/app/app"],function(a){var t=a("/modules/vue/vue");t.use(a("/modules/vue/vue-validator"));var e=a("/modules/vue/vue-common"),i=a("/modules/app/app");vue=new t({mixins:[e,i],el:"html",data:{title:"好友推荐",init:!1,rule:!1,data:{},style:"",down:!1,errorMsg:"",aniData:{aniDisplay:"block",number:""},tends:""},methods:{ruleF:function(a){a.preventDefault(),this.rule=!this.rule},userInfoCall:function(a){if(a&&a.data&&a.data.token)this.errorMsg=a.data.token,localStorage.mmToken=a.data.token,this.come(!0);else{try{this.errorMsg=JSON.stringify(a)}catch(t){alert(t)}this.come(!0)}},come:function(){var a=this;a.httpAjax({url:"/h5/referral/reward",alert:"false",showLoading:!0,success:function(t){a.data=t,0!=a.data.data.rewardList.length&&(a.style={width:Number(a.data.data.activeCash/a.data.data.recordCash*100)+"%"});try{a.data.data.desc=a.data.data.desc&&a.data.data.desc.split("\n")}catch(e){console.error(1,e)}a.init=!0,a.ani(),a.setShare()},complete:function(t){a.data=t;try{a.data.data&&"string"==typeof a.data.data.desc&&(a.data.data.desc=a.data.data.desc.split("\n"))}catch(e){console.error(2,e)}a.init=!0,a.ani(),a.setShare()}})},getShareData:function(a){var t=this.data&&this.data.data&&this.data.data.couponAmount;return t=t||0,{title:"宋仲基送你"+t+"元MEMEBOX新人优惠券！",text:"全球知名化妆品平台- 美美箱MEMEBOX电商入驻中国啦！送你"+t+"元优惠券，首次下单即可使用。超低价正品韩妆等着你！还有机会和宋欧巴亲密接触哦！",url:location.origin+"/m/special/referral/new.html"+(a?"?inviteId="+a:""),image:location.origin+"/images/app/special/song.jpg"}},setShare:function(){if(localStorage.mmToken&&this.data.data){var a=this.data.data.customerId;this.app_setShare(this.getShareData(a)),this.set_share(this.getShareData(a))}else this.app_setShare(this.getShareData())},appShare:function(){var a=this;if(this.isApp())if(localStorage.mmToken){if(this.data.data){var t=this.data.data.customerId;console.log(this.getShareData(t)),this.app_share(this.getShareData(t)),_hmt.push(["_trackEvent","referral页面","分享"])}}else this.app_login();else this.popup({title:"",type:"confirm",content:"悄悄告诉你，这个活动太划算，只能在APP内进行哦",btn:["关闭","下载APP"],ok:a.goApp()})},up:function(){this.down=!this.down},ani:function(){function a(){t.data.data.tends&&0==t.data.data.tends.length&&t.httpAjax({url:"/h5/referral/reward",alert:"false",showLoading:!0,success:function(a){t.data.data.tends=a.data.tends}}),setTimeout(function(){t.tends=t.data.data.tends.shift(),t.aniData.aniDisplay="block",setTimeout(function(){t.aniData.aniDisplay="none",e=parseInt(10*(Math.random()+.1)),t.aniData.number=e,a()},3e3)},1e3*e)}var t=this,e=parseInt(10*(Math.random()+.1));t.aniData.number=e,a(),setTimeout(function(){t.aniData.aniDisplay="none"},e)}},ready:function(){this.$refs.loading.show=!1},created:function(){var a=this;a.setShare(),a.isApp()?(localStorage.removeItem("mmToken"),a.app_userinfo(),setTimeout(function(){localStorage.mmToken||a.come()},500)):a.come()}})});