define("/modules/special/presale/list",["require","exports","module","/modules/vue/vue","/modules/vue/vue-common","/modules/app/app"],function(t){var e=t("/modules/vue/vue"),a=t("/modules/vue/vue-common"),i=t("/modules/app/app");vue=new e({mixins:[a,i],el:"html",data:{init:!1,title:"预售列表",banner:"",festivalImg:"",description:"",dataProductList:[],pageIndex:1,time:{},startTime:"",endTime:"",startedFlag:"",countdownText:""},methods:{initMui:function(){var t=this;mui.init({pullRefresh:{container:"#pullrefresh",up:{contentnomore:"没有更多产品了",callback:function(){t.getList({more:!0,self:this})}}}})},getList:function(t){var e=this;t=t||{},e.httpAjax({url:"/h5/presale/list",token:!1,param:{pageIndex:e.pageIndex},success:function(a){var i,n,s=[];if(1==a.code)if(t.more)e.dataProductList.push(a.data.list),e.pageIndex++,a.data.list.length>0?t.self.endPullupToRefresh():t.self.endPullupToRefresh(!0);else{i=a.data.list,e.banner=a.data.banner,e.festivalImg=a.data.festivalImg,e.startTime=a.data.startTime,e.endTime=a.data.endTime,e.description=a.data.description,e.dataProductList.push(a.data.list);var o,r,d=parseInt(a.data.startTime),u=parseInt(a.data.endTime);i.some(function(t){t.productId&&s.push(t.productId)}),n=s.join(","),e.httpAjax({domain:e.searchDomain,url:"/global/price",param:{productIds:n},success:function(t){"1"==t.code&&(o=t.data[0].serverTime,d>o?(r=d-o,e.startedFlag="0",e.countdownText="开始"):o>d&&u>o?(r=u-o,e.startedFlag="1",e.countdownText="结束"):(r=0,e.startedFlag="2"),e.preCountdown(r,e.time))}}),e.init=!0;var l={title:"MEMEBOX双11预售火热开启！",text:"预售低至5折还包邮，全年最低价！水光针面膜75元，预定更多爆款商品",url:location.href,image:location.origin+"/images/app/special/presale/include/11.jpg"};e.set_share(l),e.app_setShare(l),setTimeout(function(){e.initMui()},100),e.pageIndex++}}})},showPresaleRule:function(){var t=this,e="",a=[];console.log(t.description),a=t.description&&t.description.replace(/\n/g,"/n").split("/n"),a.forEach(function(t){e+='<p style="text-align: left">'+t+"</p>"}),t.popup({type:"confirm",title:"预售须知",content:e,btn:["知道啦"]})},goDetail:function(t){var e=this;"0"!=e.startedFlag&&1==t.stockStatus&&(this.isAppPresale()?this.app_product({productId:t.productId}):location.href=location.origin+this.page+"/productDetails/productDetails.html?p="+t.productId)},getUrl:function(t){var e=this;return"0"==e.startedFlag||1!=t.stockStatus||this.isAppPresale()?void 0:location.origin+this.page+"/productDetails/productDetails.html?p="+t.productId},preCountdown:function(t,a){function i(t){s=setInterval(function(){if(t>=0)n(t),t--;else if(clearInterval(s),"0"==o.startedFlag){var e=parseInt(o.endTime)-parseInt(o.startTime);o.preCountdown(e,o.time),o.startedFlag="1",o.countdownText="结束"}else"1"==o.startedFlag&&(o.startedFlag="2")},1e3)}function n(t){function i(t){return 10>t?"0"+t:t.toString()}var n=parseInt(t/60/60/24,10),s=parseInt(t/60/60%24,10),o=parseInt(t/60%60,10),r=parseInt(t%60,10);e.set(a,"day",n),e.set(a,"hour",i(s)),e.set(a,"minute",i(o)),e.set(a,"second",i(r))}var s,o=this;i(t)}},ready:function(){var t=this;setTimeout(function(){t.initMui()},100)},created:function(){this.getList()}})});