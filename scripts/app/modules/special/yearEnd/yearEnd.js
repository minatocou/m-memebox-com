define("/modules/special/yearEnd/yearEnd",["require","exports","module","/modules/vue/vue","/modules/vue/vue-common","/modules/app/app","/modules/special/yearEnd/share"],function(e){var t=e("/modules/vue/vue"),n=e("/modules/vue/vue-common"),i=e("/modules/app/app"),o=e("/modules/special/yearEnd/share"),a=document.querySelectorAll(".page-cell").length,c=document.querySelector("#year-audio"),r="2017/1/16",l="2017/1/22",u=r+"-"+l,s={"A+":"我校为拥有如你般优秀的学生<br />而骄傲！",A:"恭喜你已修够本期美丽学分，<br />可以安心回家过个好年啦～",B:"恭喜你已修够本期美丽学分，<br />可以安心回家过个好年啦～",C:"要相信，只要做足美丽功课，<br />人人都能完成成魔法般的蜕变，<br />继续努力吧！",D:"要相信，只要做足美丽功课，<br />人人都能完成成魔法般的蜕变，<br />继续努力吧！",E:"呃｀｀你｀｀<br />居然连一件美丽法器都没有纳入？！<br />美丽这件事可是一份耕耘一份收获的<br />不能懈怠啊，快去补修学分吧～！"};window.vue=new t({mixins:[n,i,o],el:"html",data:{userData:{},audioSrc:"",levelMap:["","新蜜米","铜牌蜜米","银牌蜜米","金牌蜜米","铂金蜜米","钻石蜜米","VIP蜜米","VVIP蜜米"],classList:["","vip-0","vip-1","vip-2","vip-3","vip-4","vip-5","vip-6","vip-7","vip-8"],shareBtnClassList:{1:"button-1",2:"button-2",3:"button-3"},shareBtnIndex:1,couponBtnClassList:{1:"button-4",2:"button-5"},coupon:{"A+":[{dayLimit:u,money:20,res:"美美妆仓"},{dayLimit:u,money:30,res:"中国仓"},{dayLimit:u,money:50,res:"中国仓"},{dayLimit:u,money:100,res:"美美妆仓"}],A:[{dayLimit:u,money:20,res:"美美妆仓"},{dayLimit:u,money:30,res:"中国仓"},{dayLimit:u,money:100,res:"美美妆仓"}],B:[{dayLimit:u,money:20,res:"美美妆仓"},{dayLimit:u,money:30,res:"中国仓"},{dayLimit:u,money:50,res:"中国仓"}],C:[{dayLimit:u,money:20,res:"美美妆仓"},{dayLimit:u,money:30,res:"中国仓"}]},getCouponBtnIndex:1,inviteUid:"",cellActiveIndex:"",hasloaded:!1,cellActiveList:[],notAnimation:!1,specialEffects:!1},computed:{tagShow:function(){return"string"==typeof this.cellActiveIndex||this.cellActiveIndex<=5}},methods:{syncCss:function(){this.$nextTick(function(){window.getComputedStyle(document.querySelector(".loading"),null).getPropertyValue("transform")})},togglePageCell:function(){var e=this;return e.inviteUid?(e.cellActiveIndex=0,void location.replace("#"+e.cellActiveIndex)):e.userData.productCount&&0!==Number(e.userData.productCount)?e.userData.referalOrderCount&&0!==Number(e.userData.referalOrderCount)||3!=e.cellActiveIndex?void(e.cellActiveIndex<7&&location.replace("#"+ ++e.cellActiveIndex)):(e.cellActiveIndex=5,void location.replace("#"+e.cellActiveIndex)):(e.cellActiveIndex=6,void location.replace("#"+e.cellActiveIndex))},runSpecialEffects:function(){setInterval(function(){this.specialEffects=!this.specialEffects}.bind(this),800)},scrollPage:function(){var e=0,t=0,n={touchstart:function(t){e=t.touches[0].pageY},touchend:function(n){var i=this;if(t=n.changedTouches[0].pageY,t-e>0){if(i.inviteUid)return i.cellActiveIndex=0,void location.replace("#"+i.cellActiveIndex);if(!i.userData.productCount||0===Number(i.userData.productCount))return i.cellActiveIndex=0,void location.replace("#"+i.cellActiveIndex);if((!i.userData.referalOrderCount||0===Number(i.userData.referalOrderCount))&&5==i.cellActiveIndex)return i.cellActiveIndex=3,void location.replace("#"+i.cellActiveIndex);i.cellActiveIndex>0&&location.replace("#"+--i.cellActiveIndex)}else if(0>t-e){if(i.inviteUid)return i.cellActiveIndex=6,void location.replace("#"+i.cellActiveIndex);if(!i.userData.productCount||0===Number(i.userData.productCount))return i.cellActiveIndex=6,void location.replace("#"+i.cellActiveIndex);if((!i.userData.referalOrderCount||0===Number(i.userData.referalOrderCount))&&3==i.cellActiveIndex)return i.cellActiveIndex=5,void location.replace("#"+i.cellActiveIndex);i.cellActiveIndex<6&&location.replace("#"+ ++i.cellActiveIndex),6==i.cellActiveIndex&&2==i.shareBtnIndex&&location.replace("#"+ ++i.cellActiveIndex)}}};return function(e){var t=this;t.inviteUid||n[e.type].call(t,e)}}(),loginFunc:function(){var e=this;localStorage.ref=location.pathname,e.isApp()?setTimeout(function(){e.app_login()},100):e.go("/m/account/login.html")},loginCall:function(){location.reload()},initPageData:function(e){var t=this;localStorage.customerId=e.customerId,setTimeout(function(){t.setShareFunc()}),e.productCount&&"D"!==e.score||(t.shareBtnIndex=3),0===Number(e.discount)&&(e.discount=0),t.inviteUid&&(t.shareBtnIndex=2),e.productCount&&0!==Number(e.productCount)||(e.score="E"),e.scoreText=s[e.score],e.couponList=t.coupon[e.score],t.userData=e},shareBtnEvent:function(){var e=this;if(1==e.shareBtnIndex)e.goShareFunc();else if(2==e.shareBtnIndex){if(e.inviteUid)return void location.replace(location.href.replace(location.search,"").replace(location.hash,""));location.replace("#"+ ++e.cellActiveIndex)}else e.isApp()?e.app_back({}):location.href="/m/home/home.html"},getUserData:function(){var e=this,t=Number(location.hash.substring(1,2))||0;location.replace("#"+t),e.httpAjax({url:"/h5/view/annualSummary",goLogin:!1,param:e.inviteUid&&{inviteUid:e.inviteUid}||{},success:function(n){if("1"==n.code){var i="http://secure.cn.memebox.com/media/2017/sxg.mp3";e.initPageData(n.data),e.hasloaded=!0,e.audioSrc=i,e.cellActiveIndex=t,e.syncCss(),wx.ready(function(){c&&(c.src=i,c.play())})}else mui.alert(n.msg,function(){"2"==n.code&&e.loginFunc()})}})},processAppUserData:function(){var e=this;localStorage.removeItem("mmToken"),e.app_userinfo()},userInfoCall:function(e){var t=this;e&&e.data&&e.data.token&&(this.errorMsg=e.data.token,localStorage.mmToken=e.data.token),localStorage.mmToken?t.getUserData():setTimeout(function(){t.app_login()},100)},getCouponBtnEvent:function(){var e=this;return new Date-new Date(l+" 23:59:59")>0?void mui.alert("本期活动已结束，感谢您的关注，希望下次您不要错过哦！"):void(2!=e.getCouponBtnIndex&&e.getCoupon())},getCoupon:function(){var e=this;e.httpAjax({url:"/h5/share/getAnnualCoupon",success:function(t){mui.alert(t.msg),("1"==t.code||"3"==t.code)&&(e.getCouponBtnIndex=2)}})},playAudio:function(){c.play(),c.autoplay=!0,c.isLoadedmetadata=!1,c.touchstart=!0,c.audio=!0},pauseAudio:function(){c.paused?(c.play(),this.notAnimation=!1):(c.pause(),this.notAnimation=!0),this.syncCss()}},ready:function(){var e=this;e.isApp()?e.processAppUserData():e.getUserData()},watch:{cellActiveIndex:function(){var e=[];e.length=a,"number"==typeof this.cellActiveIndex&&(e[this.cellActiveIndex]=!0),this.cellActiveList=e,this.syncCss()}},created:function(){var e=this;location.search.substring(1).split("&").forEach(function(t){-1!==t.indexOf("inviteUid")&&(e.inviteUid=t.split("=")[1])}),e.runSpecialEffects()}})});