define("/modules/brand/brandHome",["require","exports","module","/modules/vue/vue","/modules/vue/vue-common","mui"],function(e){{var a=e("/modules/vue/vue"),r=e("/modules/vue/vue-common"),t=e("mui");new a({mixins:[r],el:"html",data:{title:"品牌馆",headerColorSta:!1,headerCss:{"background-color":"rgba(255, 255, 255,0)"},brandFourCate:[],categoryfourList:[{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""}],categoryList:[],brandCateImg:"",brandList:[],pageData:{},thisBrand:null,init:!1,isEmpty:!1,toTop:!1,scrollY:0,nowBrand:null,nowCate:"",pageIndex:1,orderTotal:null,currentCate:0,brandCategory:[],allBrandPrdList:[],showPage1:!1,showPage2:!1,showPage3:!1,isNowCate:[],swiper:null,cateIndex:1,totalBrand:null,frameSrc:"",brandTips:"",currentBrandId:""},computed:{currentBrand:function(){var e=this;return{ponyef:1==e.thisBrand,imeme:2==e.thisBrand,nooni:3==e.thisBrand,bonvivant:4==e.thisBrand}}},methods:{initScroll:function(){var e,a=this;setTimeout(function(){var r=document.querySelector("#s-brand"),n=t("#s-brand").scroll({indicators:!1});r.addEventListener("scroll",function(){e=setTimeout(function(){a.scrollY=n.y,clearTimeout(e)},50)})},0)},initMui:function(){function e(){setTimeout(function(){t("#s-brand").pullRefresh().endPullupToRefresh(),10*a.pageIndex>=a.orderTotal?(a.popup({content:"没有更多商品了",time:1e3,autoClose:!0}),t("#s-brand").pullRefresh().endPullupToRefresh(!0)):(a.pageIndex++,a.getBrandList(function(e){a.brandList=a.brandList.concat(e.data)}))},0)}var a=this;t("#s-brand").pullRefresh({up:{contentrefresh:"正在加载...",contentnomore:"没有更多数据了",callback:e}})},initBrandMui:function(){function e(){setTimeout(function(){t("#brandlist").pullRefresh().endPullupToRefresh(),10*a.cateIndex>=a.totalBrand?(a.popup({content:"没有更多商品了",time:1e3,autoClose:!0}),t("#brandlist").pullRefresh().endPullupToRefresh(!0)):(a.cateIndex++,a.getBrandPrdList(a.nowBrand,a.nowCate,function(e){a.allBrandPrdList=a.allBrandPrdList.concat(e.data)}))},100)}var a=this;t("#brandlist").pullRefresh({up:{contentrefresh:"正在加载...",contentnomore:"",callback:e}})},getBrandId:function(e){var a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(a);return null!=r?r[2]:null},initBrand:function(){var e=this,a=e.getBrandId("id"),r="",t="";e.brandFourCate=[],e.getBrandData(a),e.httpAjax({url:"/h5/brand/category",param:{id:a},success:function(a){if(1==a.code){var n=a.data;if(n.length>0){e.brandCategory=n;for(var o=1;5>o;o++)e.brandFourCate.push(n[o]);r=n[1].searchBrand,t=n[1].searchCategory,e.nowBrand=r,e.nowCate=t,e.getFourCateList(r,t),e.getBrandList(),e.init=!0,e.showPage1=!0}else e.brandCategory=[],e.brandFourCate=[]}else e.popup({content:a.msg})},error:function(){e.popup({content:"程序出错了"})}}),e.initScroll()},getBrandData:function(e){var a=this;return a.pageData={},a.httpAjax({url:"/h5/brand/home",param:{brandId:e},success:function(e){if(1==e.code&&e.data){var r=e.data;if(r.hasOwnProperty("brandId")&&(a.currentBrandId=r.brandId),r.hasOwnProperty("id")&&(a.thisBrand=r.id),r.hasOwnProperty("name")&&(a.nowBrand=r.name),r.hasOwnProperty("intro")){var t=r.intro;if(t.indexOf("\\n")>=0){var n=t.replace('"\\n"',"&nbsp;\n&nbsp;");r.intro=n}a.pageData=r}}else a.popup({content:e.msg})},error:function(){a.popup({content:"程序出错了"})}}),a.pageData},getFourCateList:function(e,a,r,n){var o=this,i="",d="";o.nowCate=a,r&&(document.querySelector(".brand-nav .active").className="",r.target.className="active"),n?(o.currentCate=n,d=o.brandFourCate[n].adImg):d=o.brandFourCate[0].adImg,o.brandCateImg=d,o.categoryfourList=[{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""},{imgUrl:"",price:"",productId:""}],o.httpAjax({url:"/global/search",domain:o.searchDomain,param:{brand:e,category:a},success:function(e){if(1==e.code&&0!=e.orderTotal){i=e.data;for(var a=0;4>a;a++)i[a]&&(o.categoryfourList[a].imgUrl=i[a].imgUrl,o.categoryfourList[a].price=i[a].price,o.categoryfourList[a].productId=i[a].productId)}else o.orderTotal<10&&setTimeout(function(){t("#s-brand").pullRefresh().endPullupToRefresh(!0)},0);setTimeout(function(){o.initEcho()},10)},error:function(){o.popup({content:"程序出错了"})}})},getBrandList:function(e){var a=this,r={pageIndex:a.pageIndex,brand:a.nowBrand};a.isEmpty=!1,a.httpAjax({url:"/global/search",domain:a.searchDomain,param:r,success:function(r){a.orderTotal=r.orderTotal,e?e(r):1==r.code&&0!=r.orderTotal?a.brandList=r.data:(a.isEmpty=!0,a.brandList=[])},error:function(){a.popup({content:"程序出错了"})}})},getBrandPrdList:function(e,a,r){var n=this,o=e?e:n.nowBrand,i=a?a:"";n.isEmpty=!1,n.httpAjax({url:"/global/search",domain:n.searchDomain,param:{pageIndex:n.cateIndex,brand:o,category:i},success:function(e){n.totalBrand=e.orderTotal,r?r(e):1==e.code&&0!=e.orderTotal?n.allBrandPrdList=e.data:(n.isEmpty=!0,n.allBrandPrdList=[])},error:function(){n.popup({content:"程序出错了"})}}),t("#brandlist").scroll({indicators:!1})},changeTab:function(e){{var a=this,r=(e.target.textContent,e.target.getAttribute("value")),t=e.target.parentNode.className,n=e.target.parentNode.getAttribute("data-index");a.getBrandId("id")}return a.isNowCate=[],"active"==t?!1:(document.querySelector(".brand-topNav .active").className="",e.target.parentNode.className="active",0==n?(0==a.scrollY&&(a.headerColorSta=!1,a.headerCss={"background-color":"rgba(255, 255, 255, 0)"}),a.showPage1=!0,a.showPage2=!1,a.showPage3=!1,_maq.push(["_trackEvent","brand_page",{brand_id:a.thisBrand,brand_name:a.nowBrand}])):1==n?(a.headerColorSta=!0,a.headerCss={"background-color":"rgba(255, 255, 255, 1)"},a.showPage1=!1,a.showPage2=!0,a.showPage3=!1,a.isNowCate[0]=!0,a.getBrandPrdList(a.nowBrand,""),setTimeout(function(){a.swiper=new Swiper(".brandlist-container .swiper-container",{slidesPerView:3,paginationClickable:!0,spaceBetween:10,freeMode:!0,resistanceRatio:0})},10),_maq.push(["_trackEvent","brand_product_list",{brand_id:a.thisBrand,brand_name:a.nowBrand}])):(a.showPage1=!1,a.showPage2=!1,a.showPage3=!0,a.headerColorSta=!0,a.headerCss={"background-color":"rgba(255, 255, 255, 1)"},a.frameSrc=r,_maq.push(["_trackEvent","brand_other",{brand_id:a.thisBrand,brand_name:a.nowBrand}])),void 0)},changeCate:function(e,a,r){var t=this,n=e?e:"PONY EFFECT",o=a?a:"",i=null,d=null,s=null;if(t.nowBrand=n,t.nowCate=o,t.isNowCate=[],r){if(i=r.target.parentNode.className.split(" "),d=r.target.parentNode.getAttribute("value"),s=_.indexOf(i,"active"),-1!=s)return!1;t.isNowCate[d]=!0,t.cateIndex=1,t.getBrandPrdList(n,o)}else document.querySelector(".brand-topNav .active").className="",document.querySelector(".brand-topNav").children[1].className="active",t.headerColorSta=!0,t.headerCss={"background-color":"rgba(255, 255, 255, 1)"},t.showPage1=!1,t.showPage2=!0,t.currentCate++,t.isNowCate[t.currentCate]=!0,t.cateIndex=1,t.getBrandPrdList(n,o),setTimeout(function(){t.swiper=new Swiper(".brandlist-container .swiper-container",{slidesPerView:3,paginationClickable:!0,spaceBetween:10,freeMode:!0,resistanceRatio:0})},10)},checkAllBrand:function(){var e=this;e.changeCate(e.nowBrand,e.nowCate)},goToPage:function(e){var a=this;_maq.push(["_trackEvent","brand_other",{brand_id:a.thisBrand,brand_name:a.nowBrand,category_name:a.nowCate}]),location.href=location.origin+a.page+"/productDetails/productDetails.html#"+e}},watch:{scrollY:function(e){var a=this,r=document.body.clientHeight,t=.4*r,n=0,o=e;n=o>=0?0:0>o&&o>=-t?(-o/t).toFixed(2):1,a.headerColorSta=o>=0?!1:!0,a.headerCss={"background-color":"rgba(255, 255, 255,"+n+")"}}},ready:function(){var e=this;e.initBrandMui()},created:function(){var e=this;e.initBrand(),e.initMui(),"undefined"!=typeof Storage&&(sessionStorage.KEYNODE=3)}})}});