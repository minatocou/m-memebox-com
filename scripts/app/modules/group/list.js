define("/modules/group/list",["require","exports","module","/modules/vue/vue","/modules/vue/vue-validator","/modules/vue/vue-common","/modules/app/app"],function(t){var e=t("/modules/vue/vue");e.use(t("/modules/vue/vue-validator"));var a=t("/modules/vue/vue-common"),o=t("/modules/app/app");vue=new e({mixins:[a,o],el:"html",data:{appData:null,init:!1,errorMsg:null,dataProductList:[],pageIndex:1,bannerUrl:"",title:"拼团列表",activityNum:"",grouponType:"",expired:!1,notYet:!1},methods:{downloadApp:function(){_hmt.push(["_trackEvent","group buying_download","下载APP"])},initMui:function(){var t=this;mui.init({pullRefresh:{container:"#pullrefresh",up:{contentnomore:"没有更多产品了",callback:function(){t.getList({more:!0,self:this})}}}})},getShareData:function(t){return{title:t.title,text:t.text,url:location.href,image:t.image||"http://cn.m.memebox.com/images/app/favicon.png"}},userInfoCall:function(t){t&&t.data&&t.data.token?(this.errorMsg=t.data.token,localStorage.mmToken=t.data.token,this.getList()):this.getList()},goDetail:function(t){1==t.stockStatus&&(this.isAppGroupon()?this.app_product({productId:t.productId}):location.href=location.origin+this.page+"/productDetails/productDetails.html?p="+t.productId)},getUrl:function(t){return 1!=t.stockStatus||this.isAppGroupon()?void 0:location.origin+this.page+"/productDetails/productDetails.html?p="+t.productId},appShare:function(t){var e=this;e.set_share(this.getShareData(t)),e.app_setShare(this.getShareData(t))},getList:function(t){var e=this;t=t||{},e.httpAjax({url:"/h5/newgroupon/list",token:!1,param:{pageIndex:e.pageIndex,activityId:e.getSearch("activityId")},success:function(a){if(1==a.code){if(e.$refs.loading.show=!1,e.grouponType=a.data.grouponType,e.title=a.data.title,e.activityNum=a.data.activityNum,e.bannerUrl=a.data.banner_img,e.setTitle(e.title),a.data.product)if(t.more)e.dataProductList=e.dataProductList.concat(a.data.product),t.self.endPullupToRefresh(6*e.pageIndex>=a.data.total?!0:!1),e.pageIndex++;else{e.dataProductList=e.dataProductList.concat(a.data.product),e.init=!0;var o={title:e.title,text:"底价拼团，共享钜惠！多款超低价精品，包邮包税，各位仙女们快来参团吧~",url:location.href,image:location.origin+"/images/app/group/include/shareGroup.png"};e.appShare(o),setTimeout(function(){e.initMui()},100),e.pageIndex++}}else 3==a.code?e.expired=!0:4==a.code&&(e.expired=!0,e.notYet=!0);console.log(e.dataProductList)},complete:function(){e.init=!0}})}},created:function(){var t=this;try{t.isApp()?(localStorage.removeItem("mmToken"),setTimeout(function(){t.app_userinfo()},0)):t.getList()}catch(e){alert(e),t.getList()}}})});