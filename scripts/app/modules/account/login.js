define("/modules/account/login",["require","exports","module","/modules/vue/vue","/modules/vue/vue-validator","/modules/vue/vue-common","/modules/vue/vue-validate","/modules/app/app"],function(e){var a=e("/modules/vue/vue");a.use(e("/modules/vue/vue-validator"));{var o=e("/modules/vue/vue-common"),t=e("/modules/vue/vue-validate"),r=e("/modules/app/app");new a({mixins:[o,t,r],el:"html",param:null,quickParam:null,data:{title:"登录",init:!1,pwd:null,showAll:!1,tab:1,authCode:null},methods:{login:function(){var e=this,a=(new Date).getTime();e.valiForm(function(){e.param.password=e.base64(e.pwd+a+""),e.httpAjax({url:"/h5/customer/login",param:e.param,type:"post",headers:{nowdate:a},success:function(a){if(1==a.code){localStorage.user=JSON.stringify(a.data),localStorage.mmToken=a.data.token,localStorage.userName=e.param.userName;var o=localStorage.ref;localStorage.removeItem("ref"),o=o?o:"../home/home.html",location.href=o}}})})},quickLogin:function(){var e=this;e.valiForm(function(){e.quickParam.authCode=e.authCode,(e.getSearch("source")||localStorage.source)&&(e.quickParam.source=e.getSearch("source")||localStorage.source),localStorage.activityType&&(e.quickParam.type=localStorage.activityType),e.httpAjax({url:"/h5/customer/quickLogin",param:e.quickParam,type:"post",success:function(a){if(1==a.code){localStorage.user=JSON.stringify(a.data),localStorage.mmToken=a.data.token,localStorage.userName=e.param.userName;var o=localStorage.ref;a.data.registerOrLogin&&1==a.data.registerOrLogin&&(localStorage.isNew=1,_maq.push(["_trackEvent","success_register",{suuid:localStorage.uuid,suuid2:localStorage.uuid2,source:localStorage.source,ref:o}])),localStorage.removeItem("ref"),o=o?o:"../home/home.html",location.href=o}}})})},ref:function(){return location.search},changeTab:function(e){var a=this;a.tab=e},getAuth:function(){var e=this;e.quickParam.phone?e.httpAjax({url:"/h5/sms/getAuth",param:{userName:e.quickParam.phone,type:2},success:function(a){e.popup({content:a.msg})}}):e.popup({content:"请输入手机号"})}},ready:function(){var e=this;localStorage.removeItem("isNew"),e.getSearch("code")&&e.getSearch("state")?e.otherLoginCallBack():localStorage.mmToken?location.href="../my/home.html":(e.h5_login(null,e.getSearch("channel")),e.isWeixin()||e.isWeibo()||e.isQQ()||(e.showAll=!0,e.init=!0,e.$refs.loading.show=!1,e.$set("param.userName",localStorage.userName)))},created:function(){}})}});